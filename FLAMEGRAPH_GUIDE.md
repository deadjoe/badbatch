# ğŸ”¥ ç«ç„°å›¾åˆ†ææŒ‡å—

## å®‰è£…è¦æ±‚

### macOS ç¯å¢ƒè®¾ç½®

1. **å®‰è£… cargo-flamegraph**ï¼š
   ```bash
   cargo install flamegraph
   ```

2. **dtrace æƒé™** (macOS ç‰¹æ®Šè¦æ±‚)ï¼š
   - dtrace é»˜è®¤åœ¨ macOS ä¸Šå¯ç”¨
   - å¯èƒ½éœ€è¦ç®¡ç†å‘˜æƒé™è¿è¡Œ
   - å¦‚æœé‡åˆ°æƒé™é—®é¢˜ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨å°è¯•ä½¿ç”¨ `sudo`

## ä½¿ç”¨æ–¹æ³•

### ç”Ÿæˆç«ç„°å›¾
```bash
# è¿è¡Œç«ç„°å›¾åˆ†æ
./scripts/run_benchmarks.sh flamegraph
```

### äº¤äº’å¼é€‰æ‹©
è¿è¡Œåä¼šæ˜¾ç¤ºé€‰é¡¹èœå•ï¼š
```
Available benchmarks for flame graph analysis:
  1. comprehensive_benchmarks
  2. throughput_comparison  
  3. latency_comparison
  a. All benchmarks

Select benchmark(s) to profile (number, 'a' for all, or Enter for comprehensive):
```

### è¾“å‡ºæ–‡ä»¶
- ç«ç„°å›¾ä¿å­˜åœ¨ `flamegraphs/` ç›®å½•
- æ–‡ä»¶æ ¼å¼ï¼š`{benchmark_name}_flamegraph.svg`
- è‡ªåŠ¨åœ¨é»˜è®¤æµè§ˆå™¨ä¸­æ‰“å¼€

## ç«ç„°å›¾åˆ†ææŠ€å·§

### ğŸ” å¦‚ä½•é˜…è¯»ç«ç„°å›¾
- **å®½åº¦ = CPU æ—¶é—´**ï¼šå‡½æ•°æ¡è¶Šå®½ï¼Œæ¶ˆè€—çš„ CPU æ—¶é—´è¶Šå¤š
- **é«˜åº¦ = è°ƒç”¨æ ˆæ·±åº¦**ï¼šæ˜¾ç¤ºå‡½æ•°è°ƒç”¨å±‚æ¬¡å…³ç³»
- **é¢œè‰²**ï¼šéšæœºç”Ÿæˆï¼Œä¸ä»£è¡¨æ€§èƒ½å¥½å

### ğŸ¯ æ€§èƒ½åˆ†æè¦ç‚¹
1. **å¯»æ‰¾çƒ­ç‚¹**ï¼šæŸ¥æ‰¾æœ€å®½çš„å‡½æ•°æ¡
2. **è°ƒç”¨é“¾åˆ†æ**ï¼šè·Ÿè¸ªä»åº•éƒ¨åˆ°é¡¶éƒ¨çš„è°ƒç”¨è·¯å¾„
3. **æ„å¤–å‘ç°**ï¼šå¯»æ‰¾ä¸åº”è¯¥å‡ºç°çš„å®½å‡½æ•°æ¡
4. **æ¯”è¾ƒåˆ†æ**ï¼šå¯¹æ¯”ä¸åŒç‰ˆæœ¬çš„ç«ç„°å›¾

### ğŸ› ï¸ äº¤äº’åŠŸèƒ½
- **ç‚¹å‡»æ”¾å¤§**ï¼šç‚¹å‡»å‡½æ•°æ¡å¯æ”¾å¤§æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
- **æœç´¢åŠŸèƒ½**ï¼šä½¿ç”¨ Ctrl+F æœç´¢ç‰¹å®šå‡½æ•°å
- **é‡ç½®è§†å›¾**ï¼šåŒå‡»ç©ºç™½åŒºåŸŸé‡ç½®ç¼©æ”¾

## å¸¸è§é—®é¢˜è§£å†³

### macOS æƒé™é—®é¢˜
å¦‚æœé‡åˆ° dtrace æƒé™é”™è¯¯ï¼š
```bash
# æ–¹æ³•1ï¼šä½¿ç”¨ sudo è¿è¡Œè„šæœ¬
sudo ./scripts/run_benchmarks.sh flamegraph

# æ–¹æ³•2ï¼šä¸´æ—¶æˆæƒ dtrace
sudo dtruss -c cargo flamegraph --bench comprehensive_benchmarks
```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®
1. **è¿è¡Œå‰ä¼˜åŒ–ç³»ç»Ÿ**ï¼š
   ```bash
   ./scripts/run_benchmarks.sh optimize && ./scripts/run_benchmarks.sh flamegraph
   ```

2. **å…³é—­å…¶ä»–åº”ç”¨**ï¼šå‡å°‘ç³»ç»Ÿå™ªå£°
3. **ä½¿ç”¨ AC ç”µæº**ï¼šé¿å… CPU èŠ‚èƒ½æ¨¡å¼å½±å“

## ç¤ºä¾‹åˆ†æåœºæ™¯

### ğŸš€ ååé‡ä¼˜åŒ–
```bash
# ç”Ÿæˆååé‡æµ‹è¯•çš„ç«ç„°å›¾
./scripts/run_benchmarks.sh flamegraph
# é€‰æ‹©: 2 (throughput_comparison)
```

### âš¡ å»¶è¿Ÿä¼˜åŒ–  
```bash
# ç”Ÿæˆå»¶è¿Ÿæµ‹è¯•çš„ç«ç„°å›¾
./scripts/run_benchmarks.sh flamegraph
# é€‰æ‹©: 3 (latency_comparison)
```

### ğŸ“Š å…¨é¢åˆ†æ
```bash
# ç”Ÿæˆæ‰€æœ‰åŸºå‡†æµ‹è¯•çš„ç«ç„°å›¾
./scripts/run_benchmarks.sh flamegraph
# é€‰æ‹©: a (All benchmarks)
```

---

**æç¤º**ï¼šç«ç„°å›¾ç”Ÿæˆå¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚ç”Ÿæˆçš„ SVG æ–‡ä»¶å¯ä»¥åœ¨ä»»ä½•ç°ä»£æµè§ˆå™¨ä¸­æŸ¥çœ‹ã€‚